# RTC Payment Widget

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![RustChain](https://img.shields.io/badge/RustChain-Ecosystem-blue)](https://github.com/Scottcjn/Rustchain)

> Embeddable payment widget for accepting RTC (RustChain Token) payments on any website.

Like Stripe's checkout button, but for RustChain. One script tag, click ‚Üí pay ‚Üí done.

## üöÄ Features

- **üîê Secure by Design** - Private keys never leave the browser. All Ed25519 signing happens client-side
- **üì¶ Zero Dependencies** - Self-contained JavaScript widget with embedded crypto
- **üîó Direct to Node** - No backend required. Transactions go directly to RustChain nodes
- **üì± Responsive** - Beautiful modal that works on desktop and mobile
- **üé® Themeable** - Dark and light themes out of the box
- **üîë Multiple Wallet Methods** - Supports BIP39 seed phrases and encrypted keystore files
- **‚ö° Single Script** - No external dependencies that could be compromised
- **üîî Webhooks** - Optional callback URL for payment notifications

## üìã Quick Start

### 1. Include the Widget

```html
<script src="https://cdn.rustchain.io/rtc-pay.min.js"></script>
```

Or self-host from `dist/rtc-pay.min.js`.

### 2. Add a Container

```html
<div id="payment-button"></div>
```

### 3. Initialize

```javascript
RTCPay.init({
  recipient: 'RTC1234567890abcdef1234567890abcdef12345678',
  amount: 5.0,
  memo: 'Order #12345',
  buttonText: 'Pay Now',
  onSuccess: function(tx) {
    console.log('Payment successful!', tx);
    // tx.txHash, tx.amount, tx.recipient, tx.from
  }
}).mount('#payment-button');
```

That's it! Users click the button, enter their wallet credentials, and the payment is signed and sent.

## ‚öôÔ∏è Configuration

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `recipient` | string | **required** | RTC address to receive payment |
| `amount` | number | **required** | Amount in RTC |
| `memo` | string | `''` | Transaction memo |
| `buttonText` | string | `'Pay with RTC'` | Button label |
| `theme` | string | `'dark'` | `'dark'` or `'light'` |
| `nodeUrl` | string | `'https://50.28.86.131'` | RustChain node URL |
| `callbackUrl` | string | `null` | Webhook URL for payment notification |
| `onSuccess` | function | - | Called with transaction details on success |
| `onError` | function | - | Called with error on failure |
| `onCancel` | function | - | Called when user closes modal |

### Full Example

```javascript
const widget = RTCPay.init({
  // Required
  recipient: 'RTC1234567890abcdef1234567890abcdef12345678',
  amount: 25.50,
  
  // Optional
  memo: 'Premium Membership - 1 Year',
  buttonText: 'Subscribe Now',
  theme: 'dark',
  nodeUrl: 'https://50.28.86.131',
  callbackUrl: 'https://yoursite.com/api/payment-webhook',
  
  // Callbacks
  onSuccess: function(tx) {
    console.log('Transaction hash:', tx.txHash);
    console.log('Amount:', tx.amount, 'RTC');
    console.log('From:', tx.from);
    console.log('To:', tx.recipient);
    
    // Redirect to success page
    window.location.href = '/order-confirmed?tx=' + tx.txHash;
  },
  
  onError: function(error) {
    console.error('Payment failed:', error.message);
    alert('Payment failed: ' + error.message);
  },
  
  onCancel: function() {
    console.log('User cancelled payment');
  }
});

// Mount to DOM
widget.mount('#payment-container');

// Or open modal programmatically
widget.openModal();
```

## üîë Wallet Support

The widget supports two methods for users to connect their wallet:

### 1. Keystore File

Users can upload their encrypted JSON keystore file (generated by RustChain Wallet) and enter their password.

### 2. Seed Phrase

Users can enter their 24-word BIP39 mnemonic seed phrase with an optional passphrase.

**Security Note:** Private keys are processed entirely in the browser. They are never sent to any server.

## üíª Programmatic Wallet API

The widget also exports `RTCWallet` for programmatic use:

```javascript
// Create a new wallet
const wallet = await RTCWallet.create();
console.log(wallet.address); // RTC1234...

// Restore from 24-word seed phrase
const wallet = await RTCWallet.fromMnemonic(
  'abandon ability able about above absent absorb abstract absurd abuse access accident account accuse achieve acid acoustic acquire across act action actor actress actual'
);

// Load from encrypted keystore
const keystoreJson = { /* keystore object */ };
const wallet = await RTCWallet.fromKeystore(keystoreJson, 'myPassword123');

// Sign a transaction
const signedTx = wallet.signTransaction(
  'RTCrecipientaddress1234567890abcdef12345678',
  10.0,      // amount in RTC
  'memo',    // optional memo
  1          // nonce
);

// Export to encrypted keystore
const keystore = await wallet.toKeystore('myPassword123');
console.log(JSON.stringify(keystore));
```

## üîî Webhook Notifications

When `callbackUrl` is provided, the widget will POST payment details after successful transactions:

```json
{
  "event": "payment_success",
  "tx_hash": "abc123...",
  "from": "RTCsender...",
  "to": "RTCrecipient...",
  "amount": 25.50,
  "memo": "Order #12345",
  "timestamp": 1706745600000
}
```

## üé® Styling

### Custom Button Styling

Override the default button styles:

```css
.rtc-pay-button {
  background: #your-brand-color !important;
  border-radius: 4px !important;
  font-size: 14px !important;
}
```

### Modal Styling

The modal uses CSS variables for easy theming:

```css
.rtc-modal {
  --rtc-primary: #3b82f6;
  --rtc-success: #22c55e;
  --rtc-error: #f87171;
  --rtc-bg: #1a1a2e;
  --rtc-text: #e5e7eb;
}
```

## üîß API Reference

### RTCPay

| Method | Description |
|--------|-------------|
| `RTCPay.init(options)` | Create a new widget instance |
| `widget.mount(selector)` | Mount the payment button to a DOM element |
| `widget.openModal()` | Open the payment modal programmatically |
| `widget.closeModal()` | Close the payment modal |

### RTCWallet

| Method | Description |
|--------|-------------|
| `RTCWallet.create()` | Create a new wallet with random keys |
| `RTCWallet.fromMnemonic(words, passphrase?)` | Restore from BIP39 seed phrase |
| `RTCWallet.fromKeystore(json, password)` | Load from encrypted keystore |
| `wallet.signTransaction(to, amount, memo?, nonce?)` | Sign a transfer transaction |
| `wallet.toKeystore(password)` | Export to encrypted keystore |

## üèóÔ∏è Building from Source

```bash
# Clone the repository
git clone https://github.com/Scottcjn/Rustchain.git
cd Rustchain/rtc-payment-widget

# The widget is vanilla JavaScript - no build required!
# Just serve the files or copy dist/rtc-pay.min.js to your project

# For minification (optional):
npm install -g terser
terser src/rtc-pay.js -o dist/rtc-pay.min.js -c -m
```

## üß™ Testing

Open `examples/demo.html` in your browser to see the widget in action.

For testing payments:
1. Create a RustChain wallet at [rustchain.io](https://rustchain.io)
2. Get some testnet RTC from the faucet
3. Use the demo page to test payments

## üîí Security

- **Client-Side Only**: All cryptographic operations happen in the browser
- **No Backend**: The widget communicates directly with RustChain nodes
- **Ed25519 Signatures**: Industry-standard cryptographic signatures
- **AES-256-GCM**: Keystore encryption uses strong authenticated encryption
- **No Tracking**: The widget doesn't track users or collect analytics

### Security Best Practices

1. Always use HTTPS on your website
2. Verify the widget source hasn't been tampered with (check SHA256 hash)
3. Consider subresource integrity (SRI) when loading from CDN
4. Validate payments server-side using the callback webhook

## üìÑ License

MIT License - see [LICENSE](LICENSE)

## ü§ù Contributing

Contributions welcome! Please read the [RustChain Contributing Guidelines](https://github.com/Scottcjn/Rustchain/blob/main/CONTRIBUTING.md).

## üîó Links

- [RustChain GitHub](https://github.com/Scottcjn/Rustchain)
- [RustChain Explorer](https://50.28.86.131/explorer)
- [RustChain Bounties](https://github.com/Scottcjn/rustchain-bounties)

---

**Made with ‚ö° for the RustChain ecosystem**

*Proof of Antiquity: Your vintage hardware earns rewards.*
